# 과제
주어진 index, members, newMember html 파일을 조정하는 Controll 코드 작성하기

## Controller의 개념

- 사용자가 화면(VIEW) 단에서 입력이나 어떤 이벤트를 했을 경우, 그 이벤트에 맞는 화면(VIEW)이나 비지니스 로직(MODEL)을 실행할 수 있도록 업데이트를 해주도록 하는 역할
- 요청을 처리하는 로직을 담고 있으며 필요한 로직을 호출하는 역할
- 세부역할
    1. Data receive
    2. Interpret
    3. Validate input data
    4. Update View
    5. Modify Model
- 단순히 말하자면, 스프링 프레임워크(Spring Framework)의 컨트롤러(Controller)의 역할은 Model과 View를 이어주는 다리 역할
- Controller는 View를 리턴하는 @Controller와 Json 데이터를 리턴하는 @ResetController가 있

## Controller의 생성

- @Controller 어노테이션을 추가하여 사
- 이 @Controller 어노테이션은 어노테이션이 적용된 클래스를 컨트롤러(Controller)임을 나타내고, 자동으로 bean이 등록되어 @Controller 어노테이션이 적용된 클래스를 Controller로 사용

```java
import org.springframework.stereotype.Controller; 
// 위의 코드를 import 하려면 spring-context-x.x.x.RELEASE.jar 파일이 있어야 함

@Controller
class Test_Controller extends BaseController {	} 
// 위의 코드처럼, 컨트롤러 클래스를 1개 만들어 그 위에 @Controller 어노테이션을 추가하면 됩니다.

```

## Controller의 라우팅(@RequstMapping)

- **요청 URL에 대해 해당하는 메소드를 매핑해줄 수 있도록 하기 위해 @RequestMapping 어노테이션을 사용**
    - 여기서 매핑에 관한 것은 스프링 프레임워크(Spring Framework)의 HandlerMapping이라는 클래스 파일에 정의되어 있음
- Request Maping의 옵션
    
    
    | 옵션 | 설명 |
    | --- | --- |
    | value | 연결할 URL을 설정
    다른 옵션이 없다면 생략 가능 |
    | method | enum으로 정의되어있 RequestMethod를 통해 사용
    주로 GET, POST, PUT, DELETE를 많이 사용함 |
    | params | 쿼리문으로 파라미터를 전달받기 위해 사용 |
    - 아래 코드처럼, 컨트롤러 클래스를 1개 만들어 클래스 안에 메소드를 만들고, 그 위에 @RequestMapping 어노테이션을 추가하고, 호출 URL을 넣어주기
    
    ```java
    import org.springframework.web.bind.annotation.RequestMapping;
    
    @Controllerpublic class Test_Controller extends BaseController {	
    @RequestMapping("/a/b/json/test.*")
    public String test(HttpServletRequest request, Map model)
    throws SQLException{				return JSON_VIEW;	}
    } 
    ```
    
    - @RequestMapping annotation을 사용하려면, 아래의 코드를 import해야 함
    import org.springframework.web.bind.annotation.RequestMapping;
    - 즉, @RequestMapping 어노테이션은 @RequestMapping("/a/b/json/test.*") 에서 /a/b/json 경로와 해당하는 컨트롤러와 매핑 해주는 기능
    - 그래 서, /a/b/json 경로에 있는 test라는 이름   의 모든 확장자가 호출을 하면 test라는 메소드가 /a/b/json 경로를 맡게 되고, 이 메소드를 타서 비지니스 로직을 타게 되어 JSON_VIEW라는 값을 리턴
    - 스프링 프레임워크(Spring Framework)의 컨트롤러(Controller)의 리턴(Return)아래의 컨트롤러 클래스 코드를 보면 test라는 Method 안에 return이라는 부분이 있음

    ## Get Param

    - G**equestParam**은 클라이언트가 요청한 URL이 파라미터 값과 이름이 함께 전달할 때 쿼리스트링에서 파라미터 값을 가져오는 어노테이션
    - 대부분 Get방식의 통신에서 사용
    - 예를 들어 "localhost:8080/api/user**?username=hello&password=1234**" 로 URL요청이 들어올 때 파라미터를 받고 싶다면, 아래와 같이 작성할 수 있음
    - 쿼리문에 적힌 파라미터 이름과 메소드에 적힌 이름이 같게 하면 굳이 어노테이션을 적어주지 않아도 작동함
    
    ```java
    @RestController
    @RequestMaping("/api")
    public class MyController {
        
        @GetMapping("/user")
        public User showUser(@RequestParam String username, @RequestParam String password){ 
            ....
        }
    }
    ```
    
    → username에 "hello"가 담기고 password에는 "1234"가 들어가게 됨
    

    ## RequestBody

    - 포스트맨이나 프로그램에서 **Post 방식**과 **Put 방식**으로 객체를 전송할 때 그것을 받아오기 위해 사용할 수 있는 어노테이션
    - MessageConverter를 통해 Json데이터를 자바 객체로 변환하여 전달받음
    - **text/plain** 이나  **application/json** 타입의 데이터를 받을 때 사용
    (cf.  **x-www-form-urlencoded** 는 @ReqeustBody없이 값을 받음)

    ```java
    @RestController
    @RequestMaping("/api")
    public class MyController {
        
        @PostMapping("/join")
        public User joinUser(@RequestBody User user){  // 회원가입할 때 정보입력
            ....
        }
    }
    ```

    ## 작성한 코드
    ```java
    package mvcstudy.mvcstudy.Controller;

    import org.springframework.stereotype.Controller;
    import org.springframework.web.bind.annotation.GetMapping;
    import org.springframework.web.bind.annotation.RequestParam;
    import org.springframework.ui.Model;
    //import org.springframework.web.bind.annotation.ModelAttribute;

    @Controller
    public class SampleController {

 /* 문제 조건
    1. 사용자는 `/(루트)` 경로, `/members` 경로, `/members/new` 경로로 접근
    2. 각 경로로 접근했을 때 view에 각각 데이터가 전달되는 것을 확인하기
  */

    @GetMapping("/")    //루트 경로
    public String home(Model model) {
        model.addAttribute("description", "메인 페이지 입니다."); // key:value 구조
        return "index"; // resources:templates/ + {viewname} + .html 실행
    }

    @GetMapping("/members")
    public String showMembersPage(Model model) {
        //데이터들 View로 전달하기 위해 Model 사용
        model.addAttribute("member1", "Yeji Lee");
        model.addAttribute("member2", "Sumin Kim");
        model.addAttribute("member3", "GDSC Ewha");

        return "members";
    }


    @GetMapping("/members/new")
    public String showNewMember(@RequestParam(name = "name", defaultValue = "guest") String name,
                                @RequestParam(name = "email", defaultValue = "example@example.com") String email,
                                Model model) {

        /*
        @RequestParam: 쿼리 파라미터로 필요 정보 받아오기(url 입력 값에서 파라미터로 값 받아오기)
        "name=value1&email=value2": query string(쿼리 파라미터) 받아올 파라미터가 여러 개이므로 & 연산자 이용하기
        쿼리 파라미터의 key로 name을 받아오고 name 매개변수로 value 받아오기
         */


        //쿼리 파라미터로 name과 email 입력 받아서 전달
        model.addAttribute("name", name);
        model.addAttribute("email", email);

        return "newMember"; //내려받아온 html 파일명
    }
}
```


    # 작성한 코드

    자바 스프링을 다뤄보는 게 처음인데 과제의 중심이 controller 코드 작성이라고 생각해서 열심히 controller 자체나 파라미터를 받아오는 방법 등에 대해 주로 공부했으나, 
    1. 막상 코드 작성을 끝내고나니 파일 구조를 어떻게 해야할지 매우 헤맸음
    2. 작성한 Controller 코드로 각 html 파일을 캣톰 서버로 열어서 정상 작동하는 것을 확인할 수 있으나... 찍어올려야하는 동영상처럼 localhost로 로그인 했을 때는 수행 불가
    : 계속 Controller에 No usage 경고가 계속 뜨는 것이 분명 구조 상 문제 같은데... 해결하지 못함

